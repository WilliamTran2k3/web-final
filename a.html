<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Document</title>
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
            integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65"
            crossorigin="anonymous"
        />
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css"
            integrity="sha512-SzlrxWUlpfuzQ+pcUCosxcglQRNAq/DZjVsC0lE40xsADsfeQoEypE+enwcOiGjk/bSuGGKHEyjSoQ1zVisanQ=="
            crossorigin="anonymous"
            referrerpolicy="no-referrer"
        />
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
            integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65"
            crossorigin="anonymous"
        />
        <link rel="stylesheet" href="style.css" />
        <link rel="stylesheet" href="a.css" />
    </head>
    <body>
        <nav class="my-sidebar-bottom">
            <ul class="my-menu-bottom-links">
                <li class="my-nav-bottom-link active">
                    <a href="#" id="home">
                        <i class="fa-solid fa-house-chimney icon"></i>
                        <span class="nav-text text">Trang chủ</span>
                    </a>
                </li>
                <li class="my-nav-bottom-link">
                    <a href="#comming" id="comming">
                        <i class="fa-solid fa-calendar-days icon"></i>
                        <span class="nav-text text">Phim sắp chiếu</span>
                    </a>
                </li>
                <li class="my-nav-bottom-link">
                    <a href="#cinema" id="cinema">
                        <i class="fa-solid fa-masks-theater icon"></i>
                        <span class="nav-text text">Hệ thống rạp</span>
                    </a>
                </li>
                <li class="my-nav-bottom-link">
                    <a href="#preferential" id="preferential">
                        <i class="fa-solid fa-hand-holding-dollar icon"></i>
                        <span class="nav-text text">Ưu đãi</span>
                    </a>
                </li>
                <li class="my-nav-bottom-link has-sub-menu">
                    <i class="fa-sharp fa-solid fa-gear icon"></i>
                    <span class="nav-text text">Cài đặt</span>
                    <ul class="sub-menu-nav">
                        <li class="theme-mode">
                            <div class="toggle-switch">
                                <div class="switch"></div>
                            </div>
                            <span class="sub-menu-text">Dark Mode</span>
                        </li>
                        <li>
                            <a href="thongtinuser.html"
                                ><i class="fa-solid fa-user icon sub-icon"></i>
                                <span class="sub-menu-text">Thông tin</span></a
                            >
                        </li>
                        <li>
                            <a href="#">
                                <i
                                    class="fa-solid fa-right-from-bracket icon logout-icon sub-icon"
                                ></i>
                                <span class="sub-menu-text">Đăng xuất</span>
                            </a>
                        </li>
                    </ul>
                </li>
            </ul>
        </nav>
        <script
            src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.3/jquery.min.js"
            integrity="sha512-STof4xm1wgkfm7heWqFJVn58Hm3EtS31XFaagaa8VMReCXAkQnJZ+jEy8PCC/iT18dFy95WcExNHFTqLyp72eQ=="
            crossorigin="anonymous"
            referrerpolicy="no-referrer"
        ></script>
        <script>
            const trig = $(".my-nav-bottom-link").toArray(); // Lay tat ca the nav
            let lastClickElement = trig[0]; // Biến lưu lại phần tử vừa click, mặc định là trang home. Tối ưu thay vì dùng loop để duyệt và tìm
            let preClickElement = trig[0]; // Biến lưu lại phần tử vừa click, mặc định là trang home. Tối ưu thay vì dùng loop để duyệt và tìm
            // Gan su kien click cho cac the
            trig.forEach((element) => {
                $(element).on("click", () => {
                    // Xử lý trường hợp khi đang ở setting nhưng click vào setting một lần nữa thì mặc định trả lại trạng thái active ở trang hiện tại
                    if (
                        element === lastClickElement &&
                        $(element).hasClass("has-sub-menu")
                    ) {
                        $(preClickElement).addClass("active");
                        $(element).toggleClass("active");
                        lastClickElement = preClickElement;
                        return;
                    }
                    $(lastClickElement).removeClass("active"); // Xóa trạng thái active của thẻ đã click trước đó
                    console.log("last", $(lastClickElement));
                    if ($(element).hasClass("has-sub-menu")) {
                        $(element).addClass("active");
                    } else {
                        if (!$(element).hasClass("active")) {
                            $(element).addClass("active");
                        }
                    }
                    preClickElement = lastClickElement;
                    lastClickElement = element; // Ghi lại thẻ vừa click để xóa
                });
            });
            // trig.forEach((element) => {
            //     $(element).on("click", () => {
            //         trig.forEach((item) => {
            //             if ($(item) != $(element))
            //                 $(item).removeClass("active");
            //         });
            //         console.log($(element).hasClass("has-sub-menu"));
            //         if ($(element).hasClass("has-sub-menu")) {
            //             $(element).toggleClass("active");
            //         } else if (!$(element).hasClass("active")) {
            //             $(element).addClass("active");
            //         }
            //     });
            // });
            // const trig = document.querySelectorAll("nav li");
            // console.log(trig);
            // trig.forEach((menu) => menu.addEventListener("click", toggle));
            // function toggle() {
            //     trig.forEach((item) =>
            //         item != this ? item.classList.remove("active") : null
            //     );
            //     if (this.classList != "active") {
            //         this.classList.toggle("active");
            //     }
            // }
        </script>
    </body>
</html>
